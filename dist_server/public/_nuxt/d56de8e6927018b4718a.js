(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{308:function(t,e,n){var i=n(351);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,n(12).default)("61d59f78",i,!0,{sourceMap:!1})},350:function(t,e,n){"use strict";var i=n(308);n.n(i).a},351:function(t,e,n){(e=n(11)(!1)).push([t.i,"#globeComponentContainer{height:100%;width:100%}",""]),t.exports=e},356:function(t,e,n){"use strict";n.r(e),n(27),n(91),n(5),n(4),n(43);var i=n(18),o=(n(346),n(73),n(26)),a=n(352),r=n(353),s={data:function(){return{earthquakeDataURL:"https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson&starttime=2020-01-01&endtime=2020-01-02",worldDataURL:"https://unpkg.com/world-atlas@1.1.4/world/110m.json",countryDataURL:"https://gist.githubusercontent.com/mbostock/4090846/raw/07e73f3c2d21558489604a0bc434b3a5cf41a867/world-country-names.tsv",isDataFetched:!1,earthquakes:void 0,world:void 0,worldLand:void 0,worldCountries:void 0,countryList:void 0,canvas:void 0,context:void 0,equirectangularCanvas:void 0,equirectangularContext:void 0,colorToCountry:{},isMounted:!1,dimensions:{screenWidth:void 0,screenHeight:void 0,canvasSquareSide:400},rotations:{yaw:0,pitch:-10,roll:0},colors:{water:"#5CA8BF",land:"#91755C",selectedCountry:"#F2E4E4",earthquake:"#E32929"},autoRotationDegPerSec:5,drawLoop:void 0,lastDrawLoopCallTime:void 0,isRotating:!1,isBeingDrawn:!1,selectedCountry:void 0,dragSensitivity:75,nextUniqueColorSeed:1}},computed:{width:{get:function(){return this.dimensions.canvasSquareSide}},height:{get:function(){return this.dimensions.canvasSquareSide}},radius:{get:function(){return this.dimensions.canvasSquareSide/2}},projection:{get:function(){return a.f().translate([this.width/2,this.height/2]).clipAngle(90).precision(.1)}},graticule:{get:function(){return a.e()}},path:{get:function(){if(this.isMounted)return a.g(this.projection,this.context)}},equirectangularProjection:{get:function(){return a.d().translate([this.width/2,this.height/2]).scale(this.width/7)}},equirectangularPath:{get:function(){if(this.isMounted)return a.g(this.equirectangularProjection,this.equirectangularContext)}},autoRotationDegPerMilliSec:{get:function(){return this.autoRotationDegPerSec/1e3}},earthquakeMagnitudeScale:{get:function(){return a.j().domain([0,100]).range([0,10])}}},watch:{rotations:function(){this.projection.rotate([this.rotations.yaw,this.rotations.pitch,this.rotations.roll])}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("DOM mounted"),console.log("Fetching data"),e.next=4,t.fetchData();case 4:for(t.isDataFetched=!0,console.log(t.earthquakes),console.log(t.world),console.log(t.countryList),console.log("Mounting canvas elements"),t.canvas=a.k("#canvasContainer").append("canvas").attr("width",t.width).attr("height",t.height),t.equirectangularCanvas=a.k("#canvasContainer").append("canvas").attr("width",t.width).attr("height",t.height),t.context=t.canvas.node().getContext("2d"),t.equirectangularContext=t.equirectangularCanvas.node().getContext("2d"),t.isMounted=!0,t.equirectangularCanvas.remove(),t.configureInitialProjection(),console.log("Drawing equirectangular projection"),n=t.worldCountries.features.length;n--;)i=t.worldCountries.features[n],o=t.getUniqueRGBColor(),t.colorToCountry[o]=i,t.equirectangularContext.beginPath(),t.equirectangularPath(i),t.equirectangularContext.fillStyle=o,t.equirectangularContext.fill();console.log("Attaching event listener to canvas"),t.canvas.on("mousemove",t.selectCountry).on("touchstart",t.selectCountry).call(a.b().on("start",t.onDragStart).on("drag",t.onDrag).on("end",t.onDragEnd)),console.log("Setting draw loop timer"),t.isRotating=!0,t.lastDrawLoopCallTime=a.i(),t.drawLoop=a.l(t.draw);case 25:case"end":return e.stop()}}),e)})))()},methods:{fetchData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,a,s,c,u,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.$axios.get(t.earthquakeDataURL),o=t.$axios.get(t.worldDataURL),a=t.$axios.get(t.countryDataURL),e.next=6,Promise.all([n,o,a]);case 6:s=e.sent,c=Object(i.a)(s,3),u=c[0],l=c[1],h=c[2],t.earthquakes=u.data,t.world=l.data,t.worldLand=r.a(t.world,t.world.objects.land),t.worldCountries=r.a(t.world,t.world.objects.countries),t.countryList=t.tsv2json(h.data),e.next=25;break;case 18:e.prev=18,e.t0=e.catch(0),t.earthquake=void 0,t.world=void 0,t.worldLand=void 0,t.worldCountries=void 0,t.countryList=void 0;case 25:case"end":return e.stop()}}),e,null,[[0,18]])})))()},configureInitialProjection:function(){this.projection.scale(this.radius),this.projection.rotate([this.rotations.yaw,this.rotations.pitch,this.rotations.roll])},draw:function(t){if(!this.isDrawing){this.isDrawing=!0;var e=a.i(),n=e-this.lastDrawLoopCallTime;n<t&&(this.isRotating&&(this.rotations={yaw:this.rotations.yaw+=n*this.autoRotationDegPerMilliSec,pitch:this.rotations.pitch,roll:this.rotations.roll}),this.isMounted&&this.isDataFetched&&this.render()),this.lastDrawLoopCallTime=e,this.isDrawing=!1}},render:function(){var t=this;this.context.clearRect(0,0,this.width,this.height),this.context.lineWidth=1.5,this.context.fillStyle=this.colors.water,this.context.beginPath(),this.context.arc(this.width/2,this.height/2,this.radius,0,2*Math.PI),this.context.fill(),this.context.stroke(),this.context.lineWidth=.5,this.context.fillStyle=this.colors.land,this.context.beginPath(),this.path(this.worldCountries),this.context.fill(),this.context.stroke(),void 0!==this.selectedCountry&&(this.context.beginPath(),this.path(this.selectedCountry),this.context.fillStyle=this.colors.selectedCountry,this.context.fill());var e=a.a(this.colors.earthquake);e.opacity=.5,this.context.fillStyle=e;var n=this.path.pointRadius;this.path.pointRadius((function(e){return t.earthquakeMagnitudeScale(Math.exp(e.properties.mag))})),this.earthquakes.features.forEach((function(e){t.context.beginPath(),t.path(e),t.context.fill(),t.context.stroke()})),this.path.pointRadius(n)},selectCountry:function(){var t=this,e=a.h(a.c.target),n=this.projection.invert(e),i=this.equirectangularProjection(n);if(i[0]>-1){var o=this.equirectangularContext.getImageData(i[0],i[1],1,1),r=this.getCountryFromImageData(o);if(void 0===r)this.selectedCountry=void 0;else if(void 0===this.selectedCountry||this.selectedCountry.id!==r.id){this.selectedCountry=r;var s=this.countryList.find((function(e){return parseInt(e.id)===parseInt(t.selectedCountry.id)}));this.selectedCountry.name=s&&s.name||""}}},onDragStart:function(){this.isRotating=!1},onDrag:function(){var t=this.projection.rotate(),e=this.dragSensitivity/this.projection.scale();this.rotations={yaw:t[0]+a.c.dx*e,pitch:t[1]-a.c.dy*e,roll:this.rotations.roll}},onDragEnd:function(){this.isRotating=!0},getCountryFromImageData:function(t){var e=t.data,n="rgb("+e[0]+","+e[1]+","+e[2]+")";return this.colorToCountry[n]},getUniqueRGBColor:function(){var t=[];return this.nextUniqueColorSeed<16777215&&(t.push(255&this.nextUniqueColorSeed),t.push((65280&this.nextUniqueColorSeed)>>8),t.push((16711680&this.nextUniqueColorSeed)>>16),this.nextUniqueColorSeed+=5),"rgb("+t.join(",")+")"}}},c=n(37),u=n(41),l=n.n(u),h=n(354),d=n(300),g=n(355),v=Object(c.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{align:"center"}},[t.isDataFetched?t._e():n("div",[t._v("\n        Fetching Data ...\n      ")])])],1),t._v(" "),n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{id:"canvasContainer",align:"center"}})],1),t._v(" "),n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{align:"center"}},[void 0!==t.selectedCountry?n("div",[t._v("\n        "+t._s(t.selectedCountry.name)+"\n      ")]):t._e()])],1)],1)}),[],!1,null,null,null),f=v.exports;l()(v,{VCol:h.a,VContainer:d.a,VRow:g.a});var p={components:{Globe:f},data:function(){return{title:"Covid Athenaeum"}},head:function(){return{title:this.title,meta:[{hid:"description",name:"description",content:"Learn about COVID-19"}]}}},w=(n(350),Object(c.a)(p,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Globe")],1)}),[],!1,null,null,null));e.default=w.exports}}]);